(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function E(){}function Ie(e){return e()}function Re(){return Object.create(null)}function I(e){e.forEach(Ie)}function de(e){return typeof e=="function"}function pe(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let $;function Ae(e,t){return $||($=document.createElement("a")),$.href=t,e===$.href}function pt(e){return Object.keys(e).length===0}function Ne(e){return e&&de(e.destroy)?e.destroy:E}const _t=typeof window<"u";let mt=_t?e=>requestAnimationFrame(e):E;const Oe=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;"WeakMap"in Oe;function C(e,t){e.appendChild(t)}function b(e,t,n){e.insertBefore(t,n||null)}function y(e){e.parentNode&&e.parentNode.removeChild(e)}function v(e){return document.createElement(e)}function N(e){return document.createTextNode(e)}function D(){return N(" ")}function g(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function L(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function w(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ht(e){return Array.from(e.childNodes)}function Te(e,t){t=""+t,e.data!==t&&(e.data=t)}function ae(e,t,n,i){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}let ee;function yt(){if(ee===void 0){ee=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{ee=!0}}return ee}function bt(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const i=v("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const o=yt();let r;return o?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=g(window,"message",s=>{s.source===i.contentWindow&&t()})):(i.src="about:blank",i.onload=()=>{r=g(i.contentWindow,"resize",t),t()}),C(e,i),()=>{(o||r&&i.contentWindow)&&r(),y(i)}}function te(e,t,n){e.classList[n?"add":"remove"](t)}let X;function Q(e){X=e}function Fe(){if(!X)throw new Error("Function called outside component initialization");return X}function gt(e){Fe().$$.on_mount.push(e)}function wt(e){Fe().$$.on_destroy.push(e)}function q(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(i=>i.call(this,t))}const W=[],ie=[];let j=[];const Ce=[],Pe=Promise.resolve();let fe=!1;function Ue(){fe||(fe=!0,Pe.then(ze))}function vt(){return Ue(),Pe}function oe(e){j.push(e)}const ce=new Set;let z=0;function ze(){if(z!==0)return;const e=X;do{try{for(;z<W.length;){const t=W[z];z++,Q(t),kt(t.$$)}}catch(t){throw W.length=0,z=0,t}for(Q(null),W.length=0,z=0;ie.length;)ie.pop()();for(let t=0;t<j.length;t+=1){const n=j[t];ce.has(n)||(ce.add(n),n())}j.length=0}while(W.length);for(;Ce.length;)Ce.pop()();fe=!1,ce.clear(),Q(e)}function kt(e){if(e.fragment!==null){e.update(),I(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(oe)}}function Et(e){const t=[],n=[];j.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),j=t}const ne=new Set;let U;function Le(){U={r:0,c:[],p:U}}function Me(){U.r||I(U.c),U=U.p}function O(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function B(e,t,n,i){if(e&&e.o){if(ne.has(e))return;ne.add(e),U.c.push(()=>{ne.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}const St=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"];[...St];function We(e){e&&e.c()}function _e(e,t,n,i){const{fragment:o,after_update:r}=e.$$;o&&o.m(t,n),i||oe(()=>{const s=e.$$.on_mount.map(Ie).filter(de);e.$$.on_destroy?e.$$.on_destroy.push(...s):I(s),e.$$.on_mount=[]}),r.forEach(oe)}function me(e,t){const n=e.$$;n.fragment!==null&&(Et(n.after_update),I(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Rt(e,t){e.$$.dirty[0]===-1&&(W.push(e),Ue(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function he(e,t,n,i,o,r,s,f=[-1]){const u=X;Q(e);const c=e.$$={fragment:null,ctx:[],props:r,update:E,not_equal:o,bound:Re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:Re(),dirty:f,skip_bound:!1,root:t.target||u.$$.root};s&&s(c.root);let p=!1;if(c.ctx=n?n(e,t.props||{},(m,h,...l)=>{const _=l.length?l[0]:h;return c.ctx&&o(c.ctx[m],c.ctx[m]=_)&&(!c.skip_bound&&c.bound[m]&&c.bound[m](_),p&&Rt(e,m)),h}):[],c.update(),p=!0,I(c.before_update),c.fragment=i?i(c.ctx):!1,t.target){if(t.hydrate){const m=ht(t.target);c.fragment&&c.fragment.l(m),m.forEach(y)}else c.fragment&&c.fragment.c();t.intro&&O(e.$$.fragment),_e(e,t.target,t.anchor,t.customElement),ze()}Q(u)}class ye{$destroy(){me(this,1),this.$destroy=E}$on(t,n){if(!de(n))return E;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!pt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function At(e){let t,n,i,o,r,s,f,u,c,p,m,h,l;return{c(){t=v("div"),n=v("div"),i=N(e[2]),o=D(),r=v("label"),s=v("input"),f=D(),u=v("span"),c=D(),p=v("div"),m=N(e[3]),w(n,"class","left-option svelte-1a1qoh6"),te(n,"active",!e[0]),w(s,"type","checkbox"),w(s,"class","svelte-1a1qoh6"),w(u,"class","slider svelte-1a1qoh6"),w(r,"class","switch svelte-1a1qoh6"),w(p,"class","right-option svelte-1a1qoh6"),te(p,"active",e[0]),w(t,"class","switch-wrapper svelte-1a1qoh6"),ae(t,"--color",e[1])},m(_,R){b(_,t,R),C(t,n),C(n,i),C(t,o),C(t,r),C(r,s),s.checked=e[0],C(r,f),C(r,u),C(t,c),C(t,p),C(p,m),h||(l=[g(s,"change",e[9]),g(s,"change",e[8]),g(s,"change",Tt),g(t,"mousedown",L(e[4])),g(t,"mouseup",L(e[5])),g(t,"touchstart",L(e[6])),g(t,"touchend",L(e[7]))],h=!0)},p(_,[R]){R&4&&Te(i,_[2]),R&1&&te(n,"active",!_[0]),R&1&&(s.checked=_[0]),R&8&&Te(m,_[3]),R&1&&te(p,"active",_[0]),R&2&&ae(t,"--color",_[1])},i:E,o:E,d(_){_&&y(t),h=!1,I(l)}}}const Tt=e=>e.target.blur();function Ct(e,t,n){let{checked:i=!1}=t,{color:o="var(--color-main)"}=t,{left:r="manual"}=t,{right:s="automatic"}=t;function f(l){q.call(this,e,l)}function u(l){q.call(this,e,l)}function c(l){q.call(this,e,l)}function p(l){q.call(this,e,l)}function m(l){q.call(this,e,l)}function h(){i=this.checked,n(0,i)}return e.$$set=l=>{"checked"in l&&n(0,i=l.checked),"color"in l&&n(1,o=l.color),"left"in l&&n(2,r=l.left),"right"in l&&n(3,s=l.right)},[i,o,r,s,f,u,c,p,m,h]}class Lt extends ye{constructor(t){super(),he(this,t,Ct,At,pe,{checked:0,color:1,left:2,right:3})}}function Mt(e){let t,n;return{c:E,m(i,o){t||(n=[g(window,"keydown",e[0]),g(window,"keyup",e[1])],t=!0)},p:E,i:E,o:E,d(i){t=!1,I(n)}}}function qt(e,t,n){let{record:i}=t,{stopRecording:o}=t;function r(u){u.preventDefault(),i()}gt(()=>{const u=document.querySelector("main");return u.addEventListener("mousedown",r),u.addEventListener("mouseup",o),u.addEventListener("touchstart",r),u.addEventListener("touchend",o),()=>{u.removeEventListener("mousedown",r),u.removeEventListener("mouseup",o),u.removeEventListener("touchstart",r),u.removeEventListener("touchend",o)}});function s(u){u.code==="Space"&&i()}function f(u){u.code==="Space"&&o()}return e.$$set=u=>{"record"in u&&n(2,i=u.record),"stopRecording"in u&&n(3,o=u.stopRecording)},[s,f,i,o]}class Dt extends ye{constructor(t){super(),he(this,t,qt,Mt,pe,{record:2,stopRecording:3})}}const{cancelAnimationFrame:It}=Oe;function qe(e){let t,n;return t=new Dt({props:{record:e[16],stopRecording:e[17]}}),{c(){We(t.$$.fragment)},m(i,o){_e(t,i,o),n=!0},p:E,i(i){n||(O(t.$$.fragment,i),n=!0)},o(i){B(t.$$.fragment,i),n=!1},d(i){me(t,i)}}}function De(e){let t,n,i=!0,o=!1,r,s,f;function u(){It(r),t.paused||(r=mt(u),o=!0),e[33].call(t)}return{c(){t=v("audio"),Ae(t.src,n=e[9])||w(t,"src",n)},m(c,p){b(c,t,p),e[31](t),s||(f=[g(t,"play",e[32]),g(t,"pause",e[32]),g(t,"timeupdate",u),g(t,"ended",e[19]),Ne(e[15].call(null,t))],s=!0)},p(c,p){p[0]&512&&!Ae(t.src,n=c[9])&&w(t,"src",n),p[0]&8&&i!==(i=c[3])&&t[i?"pause":"play"](),!o&&p[0]&256&&!isNaN(c[8])&&(t.currentTime=c[8]),o=!1},d(c){c&&y(t),e[31](null),s=!1,I(f)}}}function Nt(e){let t,n;return{c(){t=v("b"),t.textContent="getUserMedia",n=N(" is not supported on your browser ðŸ˜”")},m(i,o){b(i,t,o),b(i,n,o)},p:E,i:E,o:E,d(i){i&&y(t),i&&y(n)}}}function Ot(e){let t,n,i;return{c(){t=v("p"),t.textContent="You need to grant access to your microphone",n=D(),i=v("p"),i.textContent="Watch out for a dialog or microphone icon in the address bar",ae(t,"font-weight","bold")},m(o,r){b(o,t,r),b(o,n,r),b(o,i,r)},p:E,i:E,o:E,d(o){o&&y(t),o&&y(n),o&&y(i)}}}function Ft(e){let t,n,i,o,r,s;t=new Lt({props:{checked:e[6]}}),t.$on("change",e[20]);function f(l,_){return l[6]?zt:Ut}let u=f(e),c=u(e);function p(l,_){if(l[10])return jt;if(!l[3]||l[11])return Bt;if(l[9])return Wt}let m=p(e),h=m&&m(e);return{c(){We(t.$$.fragment),n=D(),i=v("p"),c.c(),o=D(),r=v("div"),h&&h.c(),w(i,"id","instruction"),w(i,"class","svelte-uxyny"),w(r,"id","control-btns"),w(r,"class","svelte-uxyny")},m(l,_){_e(t,l,_),b(l,n,_),b(l,i,_),c.m(i,null),b(l,o,_),b(l,r,_),h&&h.m(r,null),s=!0},p(l,_){const R={};_[0]&64&&(R.checked=l[6]),t.$set(R),u!==(u=f(l))&&(c.d(1),c=u(l),c&&(c.c(),c.m(i,null))),m===(m=p(l))&&h?h.p(l,_):(h&&h.d(1),h=m&&m(l),h&&(h.c(),h.m(r,null)))},i(l){s||(O(t.$$.fragment,l),s=!0)},o(l){B(t.$$.fragment,l),s=!1},d(l){me(t,l),l&&y(n),l&&y(i),c.d(),l&&y(o),l&&y(r),h&&h.d()}}}function Pt(e){let t,n,i,o,r;return{c(){t=v("p"),t.textContent="Record yourself and listen to the echo",n=D(),i=v("button"),i.textContent="initialize",w(i,"id","init-btn"),w(i,"class","svelte-uxyny")},m(s,f){b(s,t,f),b(s,n,f),b(s,i,f),o||(r=g(i,"click",L(e[14])),o=!0)},p:E,i:E,o:E,d(s){s&&y(t),s&&y(n),s&&y(i),o=!1,r()}}}function Ut(e){let t,n,i,o,r;return{c(){t=N("Clickâ€‰/â€‰touch anywhere on the screen or press 'Space' "),n=v("u"),n.textContent="and hold",i=N(` to
                        record.`),o=v("br"),r=N(`
                        Release to stop recording and listen to playback in a loop.`)},m(s,f){b(s,t,f),b(s,n,f),b(s,i,f),b(s,o,f),b(s,r,f)},d(s){s&&y(t),s&&y(n),s&&y(i),s&&y(o),s&&y(r)}}}function zt(e){let t,n,i;return{c(){t=N("Simply start speaking to start recording."),n=v("br"),i=N(`
                        Stop speaking to stop recording and listen to playback in a loop.`)},m(o,r){b(o,t,r),b(o,n,r),b(o,i,r)},d(o){o&&y(t),o&&y(n),o&&y(i)}}}function Wt(e){let t,n,i;return{c(){t=v("button"),t.textContent="â–¶ï¸Ž PLAY",w(t,"id","play-btn"),w(t,"class","svelte-uxyny")},m(o,r){b(o,t,r),n||(i=[g(t,"click",L(e[21])),g(t,"mousedown",L(e[26])),g(t,"mouseup",L(e[27])),g(t,"touchstart",L(e[28])),g(t,"touchend",L(e[29]))],n=!0)},p:E,d(o){o&&y(t),n=!1,I(i)}}}function Bt(e){let t,n,i;return{c(){t=v("button"),t.textContent="â—¼ï¸Ž STOP",w(t,"id","stop-btn"),w(t,"class","svelte-uxyny")},m(o,r){b(o,t,r),n||(i=[g(t,"click",L(e[18])),g(t,"mousedown",L(e[22])),g(t,"mouseup",L(e[23])),g(t,"touchstart",L(e[24])),g(t,"touchend",L(e[25]))],n=!0)},p:E,d(o){o&&y(t),n=!1,I(i)}}}function jt(e){let t;return{c(){t=v("div"),t.textContent="REC",w(t,"class","recording svelte-uxyny")},m(n,i){b(n,t,i)},p:E,d(n){n&&y(t)}}}function Vt(e){let t,n,i,o,r,s,f,u,c,p,m,h,l,_,R,k=e[4]&&!e[6]&&qe(e),S=e[9]&&De(e);const F=[Pt,Ft,Ot,Nt],A=[];function M(d,T){return d[4]?d[12]&&d[5]?1:d[12]&&!d[5]?2:3:0}return f=M(e),u=A[f]=F[f](e),{c(){k&&k.c(),t=D(),S&&S.c(),n=D(),i=v("main"),o=v("div"),r=v("h1"),r.textContent="Svecho",s=D(),u.c(),c=D(),p=v("div"),m=v("canvas"),w(r,"class","svelte-uxyny"),w(o,"id","control"),w(o,"class","svelte-uxyny"),w(m,"class","svelte-uxyny"),w(p,"id","visual-wrapper"),w(p,"class","svelte-uxyny"),oe(()=>e[35].call(p)),w(i,"class","svelte-uxyny")},m(d,T){k&&k.m(d,T),b(d,t,T),S&&S.m(d,T),b(d,n,T),b(d,i,T),C(i,o),C(o,r),C(o,s),A[f].m(o,null),C(i,c),C(i,p),C(p,m),e[34](m),h=bt(p,e[35].bind(p)),l=!0,_||(R=[g(window,"keydown",e[30]),Ne(e[13].call(null,m))],_=!0)},p(d,T){d[4]&&!d[6]?k?(k.p(d,T),T[0]&80&&O(k,1)):(k=qe(d),k.c(),O(k,1),k.m(t.parentNode,t)):k&&(Le(),B(k,1,1,()=>{k=null}),Me()),d[9]?S?S.p(d,T):(S=De(d),S.c(),S.m(n.parentNode,n)):S&&(S.d(1),S=null);let V=f;f=M(d),f===V?A[f].p(d,T):(Le(),B(A[V],1,1,()=>{A[V]=null}),Me(),u=A[f],u?u.p(d,T):(u=A[f]=F[f](d),u.c()),O(u,1),u.m(o,null))},i(d){l||(O(k),O(u),l=!0)},o(d){B(k),B(u),l=!1},d(d){k&&k.d(d),d&&y(t),S&&S.d(d),d&&y(n),d&&y(i),A[f].d(),e[34](null),h(),_=!1,I(R)}}}const ue=128,Ht=800,Kt=500,Yt=50,Gt=600;function Zt(e,t,n){let i;const o=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=-45;let s=!1,f=!1,u=!1,c,p=[],m,h,l=[],_,R=[],k,S,F,A,M,d,T;function V(a){T=a.getContext("2d")}let be=!1,P=!1,H=!0;async function Be(){m=new AudioContext,await je(),n(4,s=!0)}wt(()=>{clearInterval(le),clearTimeout(Y),clearTimeout(G)});async function je(){try{const a=await navigator.mediaDevices.getUserMedia({audio:!0});n(5,f=!0),c=new MediaRecorder(a),c.onstart=()=>{},c.ondataavailable=J=>{P?(p.push(J.data),n(10,P=!1)):p=[]},c.onstop=async()=>{if(p.length===0)return;const J=new Blob(p,{type:c.mimeType});p=[],F&&URL.revokeObjectURL(F),n(9,F=URL.createObjectURL(J)),await vt(),await se()};const Z=m.createMediaStreamSource(a);_=m.createAnalyser(),_.fftSize=ue,_.minDecibels=r,Z.connect(_);const x=_.frequencyBinCount;R=new Uint8Array(x)}catch(a){console.error(`The following getUserMedia error occurred: ${a}`)}}function Ve(a){const Z=m.createMediaElementSource(a);h=m.createAnalyser(),h.fftSize=ue,Z.connect(h),h.connect(m.destination);const x=h.frequencyBinCount;l=new Uint8Array(x)}let ge;function we(){if(T.clearRect(0,0,A,M),T.fillStyle="#ff3b00",H&&!K){cancelAnimationFrame(ge),l=l.fill(0);return}h.getByteFrequencyData(l),l.forEach((a,Z)=>{const J=Z*i+1,at=M-a/255*M,ft=i-2*1,dt=a/255*M;T.fillRect(J,at,ft,dt)}),ge=requestAnimationFrame(we)}let ve;function ke(){if(!u){cancelAnimationFrame(ve);return}_.getByteFrequencyData(R),be=R.some(a=>a>0),be?Ge():Ze(),ve=requestAnimationFrame(ke)}async function Ee(){P||(n(10,P=!0),re(),!u&&c.state==="inactive"&&c.start())}function Se(){P&&(c.stop(),u&&c.start())}let K=null;function re(){k&&(clearTimeout(K),n(11,K=null),k.pause(),n(8,S=0))}function He(){n(11,K=setTimeout(se,Ht))}let le;function Ke(){le=setInterval(Ye,Kt)}function Ye(){P||(c.state==="recording"&&c.stop(),c.state==="inactive"&&c.start())}let Y;function Ge(){clearTimeout(G),G=null,Y||(Y=setTimeout(()=>{Ee()},Yt))}let G;function Ze(){clearTimeout(Y),Y=null,G||(G=setTimeout(()=>{Se()},Gt))}function Je(a){n(6,u=a.target.checked),c.state==="recording"&&c.stop(),u?(c.start(),Ke(),ke()):clearInterval(le)}async function se(){try{await k.play()}catch(a){console.error("ERROR playing audio",a)}}function Qe(a){q.call(this,e,a)}function Xe(a){q.call(this,e,a)}function xe(a){q.call(this,e,a)}function $e(a){q.call(this,e,a)}function et(a){q.call(this,e,a)}function tt(a){q.call(this,e,a)}function nt(a){q.call(this,e,a)}function it(a){q.call(this,e,a)}const ot=a=>{a.code==="Escape"&&re()};function rt(a){ie[a?"unshift":"push"](()=>{k=a,n(7,k)})}function lt(){H=this.paused,n(3,H)}function st(){S=this.currentTime,n(8,S)}function ct(a){ie[a?"unshift":"push"](()=>{d=a,n(2,d),n(0,A),n(1,M)})}function ut(){A=this.clientWidth,M=this.clientHeight,n(0,A),n(1,M)}return e.$$.update=()=>{e.$$.dirty[0]&1&&(i=A/ue*2),e.$$.dirty[0]&7&&d&&A&&M&&(n(2,d.width=A,d),n(2,d.height=M,d)),e.$$.dirty[0]&8&&(H||we())},[A,M,d,H,s,f,u,k,S,F,P,K,o,V,Be,Ve,Ee,Se,re,He,Je,se,Qe,Xe,xe,$e,et,tt,nt,it,ot,rt,lt,st,ct,ut]}class Jt extends ye{constructor(t){super(),he(this,t,Zt,Vt,pe,{},null,[-1,-1])}}new Jt({target:document.getElementById("app")});
