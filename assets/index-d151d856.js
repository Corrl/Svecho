(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function E(){}function Me(e){return e()}function Se(){return Object.create(null)}function I(e){e.forEach(Me)}function ue(e){return typeof e=="function"}function ae(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function it(e){return Object.keys(e).length===0}function rt(e){return e&&ue(e.destroy)?e.destroy:E}const st=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;"WeakMap"in st;function L(e,t){e.appendChild(t)}function b(e,t,n){e.insertBefore(t,n||null)}function y(e){e.parentNode&&e.parentNode.removeChild(e)}function w(e){return document.createElement(e)}function q(e){return document.createTextNode(e)}function D(){return q(" ")}function k(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function C(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function v(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function lt(e){return Array.from(e.childNodes)}function Re(e,t){t=""+t,e.data!==t&&(e.data=t)}function se(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}let X;function ct(){if(X===void 0){X=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{X=!0}}return X}function ut(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const o=w("iframe");o.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),o.setAttribute("aria-hidden","true"),o.tabIndex=-1;const i=ct();let r;return i?(o.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=k(window,"message",s=>{s.source===o.contentWindow&&t()})):(o.src="about:blank",o.onload=()=>{r=k(o.contentWindow,"resize",t),t()}),L(e,o),()=>{(i||r&&o.contentWindow)&&r(),y(o)}}function x(e,t,n){e.classList[n?"add":"remove"](t)}let Z;function G(e){Z=e}function De(){if(!Z)throw new Error("Function called outside component initialization");return Z}function at(e){De().$$.on_mount.push(e)}function ft(e){De().$$.on_destroy.push(e)}function T(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(o=>o.call(this,t))}const F=[],le=[];let B=[];const Le=[],dt=Promise.resolve();let ce=!1;function pt(){ce||(ce=!0,dt.then(Ie))}function ee(e){B.push(e)}const ie=new Set;let z=0;function Ie(){if(z!==0)return;const e=Z;do{try{for(;z<F.length;){const t=F[z];z++,G(t),ht(t.$$)}}catch(t){throw F.length=0,z=0,t}for(G(null),F.length=0,z=0;le.length;)le.pop()();for(let t=0;t<B.length;t+=1){const n=B[t];ie.has(n)||(ie.add(n),n())}B.length=0}while(F.length);for(;Le.length;)Le.pop()();ce=!1,ie.clear(),G(e)}function ht(e){if(e.fragment!==null){e.update(),I(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ee)}}function mt(e){const t=[],n=[];B.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),B=t}const $=new Set;let U;function Ae(){U={r:0,c:[],p:U}}function Ce(){U.r||I(U.c),U=U.p}function N(e,t){e&&e.i&&($.delete(e),e.i(t))}function W(e,t,n,o){if(e&&e.o){if($.has(e))return;$.add(e),U.c.push(()=>{$.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}const _t=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"];[..._t];function qe(e){e&&e.c()}function fe(e,t,n,o){const{fragment:i,after_update:r}=e.$$;i&&i.m(t,n),o||ee(()=>{const s=e.$$.on_mount.map(Me).filter(ue);e.$$.on_destroy?e.$$.on_destroy.push(...s):I(s),e.$$.on_mount=[]}),r.forEach(ee)}function de(e,t){const n=e.$$;n.fragment!==null&&(mt(n.after_update),I(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function yt(e,t){e.$$.dirty[0]===-1&&(F.push(e),pt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function pe(e,t,n,o,i,r,s,f=[-1]){const u=Z;G(e);const c=e.$$={fragment:null,ctx:[],props:r,update:E,not_equal:i,bound:Se(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:Se(),dirty:f,skip_bound:!1,root:t.target||u.$$.root};s&&s(c.root);let g=!1;if(c.ctx=n?n(e,t.props||{},(_,d,...l)=>{const h=l.length?l[0]:d;return c.ctx&&i(c.ctx[_],c.ctx[_]=h)&&(!c.skip_bound&&c.bound[_]&&c.bound[_](h),g&&yt(e,_)),d}):[],c.update(),g=!0,I(c.before_update),c.fragment=o?o(c.ctx):!1,t.target){if(t.hydrate){const _=lt(t.target);c.fragment&&c.fragment.l(_),_.forEach(y)}else c.fragment&&c.fragment.c();t.intro&&N(e.$$.fragment),fe(e,t.target,t.anchor,t.customElement),Ie()}G(u)}class he{$destroy(){de(this,1),this.$destroy=E}$on(t,n){if(!ue(n))return E;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!it(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function gt(e){let t,n,o,i,r,s,f,u,c,g,_,d,l;return{c(){t=w("div"),n=w("div"),o=q(e[2]),i=D(),r=w("label"),s=w("input"),f=D(),u=w("span"),c=D(),g=w("div"),_=q(e[3]),v(n,"class","left-option svelte-1a1qoh6"),x(n,"active",!e[0]),v(s,"type","checkbox"),v(s,"class","svelte-1a1qoh6"),v(u,"class","slider svelte-1a1qoh6"),v(r,"class","switch svelte-1a1qoh6"),v(g,"class","right-option svelte-1a1qoh6"),x(g,"active",e[0]),v(t,"class","switch-wrapper svelte-1a1qoh6"),se(t,"--color",e[1])},m(h,m){b(h,t,m),L(t,n),L(n,o),L(t,i),L(t,r),L(r,s),s.checked=e[0],L(r,f),L(r,u),L(t,c),L(t,g),L(g,_),d||(l=[k(s,"change",e[9]),k(s,"change",e[8]),k(s,"change",bt),k(t,"mousedown",C(e[4])),k(t,"mouseup",C(e[5])),k(t,"touchstart",C(e[6])),k(t,"touchend",C(e[7]))],d=!0)},p(h,[m]){m&4&&Re(o,h[2]),m&1&&x(n,"active",!h[0]),m&1&&(s.checked=h[0]),m&8&&Re(_,h[3]),m&1&&x(g,"active",h[0]),m&2&&se(t,"--color",h[1])},i:E,o:E,d(h){h&&y(t),d=!1,I(l)}}}const bt=e=>e.target.blur();function vt(e,t,n){let{checked:o=!1}=t,{color:i="var(--color-main)"}=t,{left:r="manual"}=t,{right:s="automatic"}=t;function f(l){T.call(this,e,l)}function u(l){T.call(this,e,l)}function c(l){T.call(this,e,l)}function g(l){T.call(this,e,l)}function _(l){T.call(this,e,l)}function d(){o=this.checked,n(0,o)}return e.$$set=l=>{"checked"in l&&n(0,o=l.checked),"color"in l&&n(1,i=l.color),"left"in l&&n(2,r=l.left),"right"in l&&n(3,s=l.right)},[o,i,r,s,f,u,c,g,_,d]}class wt extends he{constructor(t){super(),pe(this,t,vt,gt,ae,{checked:0,color:1,left:2,right:3})}}function kt(e){let t,n;return{c:E,m(o,i){t||(n=[k(window,"keydown",e[0]),k(window,"keyup",e[1])],t=!0)},p:E,i:E,o:E,d(o){t=!1,I(n)}}}function Et(e,t,n){let{record:o}=t,{stopRecording:i}=t;function r(u){u.preventDefault(),o()}at(()=>{const u=document.querySelector("main");return u.addEventListener("mousedown",r),u.addEventListener("mouseup",i),u.addEventListener("touchstart",r),u.addEventListener("touchend",i),()=>{u.removeEventListener("mousedown",r),u.removeEventListener("mouseup",i),u.removeEventListener("touchstart",r),u.removeEventListener("touchend",i)}});function s(u){u.code==="Space"&&o()}function f(u){u.code==="Space"&&i()}return e.$$set=u=>{"record"in u&&n(2,o=u.record),"stopRecording"in u&&n(3,i=u.stopRecording)},[s,f,o,i]}class St extends he{constructor(t){super(),pe(this,t,Et,kt,ae,{record:2,stopRecording:3})}}function Te(e){let t,n;return t=new St({props:{record:e[13],stopRecording:e[14]}}),{c(){qe(t.$$.fragment)},m(o,i){fe(t,o,i),n=!0},p:E,i(o){n||(N(t.$$.fragment,o),n=!0)},o(o){W(t.$$.fragment,o),n=!1},d(o){de(t,o)}}}function Rt(e){let t,n;return{c(){t=w("b"),t.textContent="getUserMedia",n=q(" is not supported on your browser ðŸ˜”")},m(o,i){b(o,t,i),b(o,n,i)},p:E,i:E,o:E,d(o){o&&y(t),o&&y(n)}}}function Lt(e){let t,n,o;return{c(){t=w("p"),t.textContent="You need to grant access to your microphone",n=D(),o=w("p"),o.textContent="Watch out for a dialog or microphone icon in the address bar",se(t,"font-weight","bold")},m(i,r){b(i,t,r),b(i,n,r),b(i,o,r)},p:E,i:E,o:E,d(i){i&&y(t),i&&y(n),i&&y(o)}}}function At(e){let t,n,o,i,r,s;t=new wt({props:{checked:e[6]}}),t.$on("change",e[17]);function f(l,h){return l[6]?Mt:Tt}let u=f(e),c=u(e);function g(l,h){if(l[8])return qt;if(!l[3]||l[9])return It;if(l[7])return Dt}let _=g(e),d=_&&_(e);return{c(){qe(t.$$.fragment),n=D(),o=w("p"),c.c(),i=D(),r=w("div"),d&&d.c(),v(o,"id","instruction"),v(o,"class","svelte-uxyny"),v(r,"id","control-btns"),v(r,"class","svelte-uxyny")},m(l,h){fe(t,l,h),b(l,n,h),b(l,o,h),c.m(o,null),b(l,i,h),b(l,r,h),d&&d.m(r,null),s=!0},p(l,h){const m={};h[0]&64&&(m.checked=l[6]),t.$set(m),u!==(u=f(l))&&(c.d(1),c=u(l),c&&(c.c(),c.m(o,null))),_===(_=g(l))&&d?d.p(l,h):(d&&d.d(1),d=_&&_(l),d&&(d.c(),d.m(r,null)))},i(l){s||(N(t.$$.fragment,l),s=!0)},o(l){W(t.$$.fragment,l),s=!1},d(l){de(t,l),l&&y(n),l&&y(o),c.d(),l&&y(i),l&&y(r),d&&d.d()}}}function Ct(e){let t,n,o,i,r;return{c(){t=w("p"),t.textContent="Record yourself and listen to the echo",n=D(),o=w("button"),o.textContent="initialize",v(o,"id","init-btn"),v(o,"class","svelte-uxyny")},m(s,f){b(s,t,f),b(s,n,f),b(s,o,f),i||(r=k(o,"click",C(e[12])),i=!0)},p:E,i:E,o:E,d(s){s&&y(t),s&&y(n),s&&y(o),i=!1,r()}}}function Tt(e){let t,n,o,i,r;return{c(){t=q("Clickâ€‰/â€‰touch anywhere on the screen or press 'Space' "),n=w("u"),n.textContent="and hold",o=q(` to
                        record.`),i=w("br"),r=q(`
                        Release to stop recording and listen to playback in a loop.`)},m(s,f){b(s,t,f),b(s,n,f),b(s,o,f),b(s,i,f),b(s,r,f)},d(s){s&&y(t),s&&y(n),s&&y(o),s&&y(i),s&&y(r)}}}function Mt(e){let t,n,o;return{c(){t=q("Simply start speaking to start recording."),n=w("br"),o=q(`
                        Stop speaking to stop recording and listen to playback in a loop.`)},m(i,r){b(i,t,r),b(i,n,r),b(i,o,r)},d(i){i&&y(t),i&&y(n),i&&y(o)}}}function Dt(e){let t,n,o;return{c(){t=w("button"),t.textContent="â–¶ï¸Ž PLAY",v(t,"id","play-btn"),v(t,"class","svelte-uxyny")},m(i,r){b(i,t,r),n||(o=[k(t,"click",C(e[16])),k(t,"mousedown",C(e[22])),k(t,"mouseup",C(e[23])),k(t,"touchstart",C(e[24])),k(t,"touchend",C(e[25]))],n=!0)},p:E,d(i){i&&y(t),n=!1,I(o)}}}function It(e){let t,n,o;return{c(){t=w("button"),t.textContent="â—¼ï¸Ž STOP",v(t,"id","stop-btn"),v(t,"class","svelte-uxyny")},m(i,r){b(i,t,r),n||(o=[k(t,"click",C(e[15])),k(t,"mousedown",C(e[18])),k(t,"mouseup",C(e[19])),k(t,"touchstart",C(e[20])),k(t,"touchend",C(e[21]))],n=!0)},p:E,d(i){i&&y(t),n=!1,I(o)}}}function qt(e){let t;return{c(){t=w("div"),t.textContent="REC",v(t,"class","recording svelte-uxyny")},m(n,o){b(n,t,o)},p:E,d(n){n&&y(t)}}}function Ot(e){let t,n,o,i,r,s,f,u,c,g,_,d,l,h,m=e[4]&&!e[6]&&Te(e);const S=[Ct,At,Lt,Rt],A=[];function M(p,R){return p[4]?p[10]&&p[5]?1:p[10]&&!p[5]?2:3:0}return s=M(e),f=A[s]=S[s](e),{c(){m&&m.c(),t=D(),n=w("main"),o=w("div"),i=w("h1"),i.textContent="Svecho",r=D(),f.c(),u=D(),c=w("div"),g=w("canvas"),v(i,"class","svelte-uxyny"),v(o,"id","control"),v(o,"class","svelte-uxyny"),v(g,"class","svelte-uxyny"),v(c,"id","visual-wrapper"),v(c,"class","svelte-uxyny"),ee(()=>e[28].call(c)),v(n,"class","svelte-uxyny")},m(p,R){m&&m.m(p,R),b(p,t,R),b(p,n,R),L(n,o),L(o,i),L(o,r),A[s].m(o,null),L(n,u),L(n,c),L(c,g),e[27](g),_=ut(c,e[28].bind(c)),d=!0,l||(h=[k(window,"keydown",e[26]),rt(e[11].call(null,g))],l=!0)},p(p,R){p[4]&&!p[6]?m?(m.p(p,R),R[0]&80&&N(m,1)):(m=Te(p),m.c(),N(m,1),m.m(t.parentNode,t)):m&&(Ae(),W(m,1,1,()=>{m=null}),Ce());let O=s;s=M(p),s===O?A[s].p(p,R):(Ae(),W(A[O],1,1,()=>{A[O]=null}),Ce(),f=A[s],f?f.p(p,R):(f=A[s]=S[s](p),f.c()),N(f,1),f.m(o,null))},i(p){d||(N(m),N(f),d=!0)},o(p){W(m),W(f),d=!1},d(p){m&&m.d(p),p&&y(t),p&&y(n),A[s].d(),e[27](null),_(),l=!1,I(h)}}}const re=128,Nt=800,Pt=500,Ut=50,zt=600;function Ft(e,t,n){let o;const i=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=-45;let s=!1,f=!1,u=!1,c,g=[],_,d,l=[],h,m=[],S,A,M,p,R,O;function Oe(a){O=a.getContext("2d")}let me=!1,P=!1,J=!0;async function Ne(){_=new AudioContext,await Pe(),n(4,s=!0)}async function Pe(){try{const a=await navigator.mediaDevices.getUserMedia({audio:!0});n(5,f=!0),c=new MediaRecorder(a),c.onstart=()=>{},c.ondataavailable=Y=>{P?(g.push(Y.data),n(8,P=!1)):g=[]},c.onstop=()=>{if(g.length===0)return;const Y=new Blob(g,{type:c.mimeType});g=[],A&&URL.revokeObjectURL(A),n(7,A=URL.createObjectURL(Y)),S?S.src=A:Ue(A),S.load(),ne()};const K=_.createMediaStreamSource(a);h=_.createAnalyser(),h.fftSize=re,h.minDecibels=r,K.connect(h);const Ee=h.frequencyBinCount;m=new Uint8Array(Ee)}catch(a){console.error(`The following getUserMedia error occurred: ${a}`)}}function Ue(a){S=new Audio(a),S.addEventListener("play",Q),S.addEventListener("pause",Q),S.addEventListener("ended",ke),ze()}function ze(){const a=_.createMediaElementSource(S);d=_.createAnalyser(),d.fftSize=re,a.connect(d),d.connect(_.destination);const K=d.frequencyBinCount;l=new Uint8Array(K)}let _e;function ye(){if(O.clearRect(0,0,M,p),O.fillStyle="#ff3b00",J&&!j){cancelAnimationFrame(_e),l=l.fill(0);return}d.getByteFrequencyData(l),l.forEach((a,K)=>{const Y=K*o+1,tt=p-a/255*p,nt=o-2*1,ot=a/255*p;O.fillRect(Y,tt,nt,ot)}),_e=requestAnimationFrame(ye)}let ge;function be(){if(!u){cancelAnimationFrame(ge);return}h.getByteFrequencyData(m),me=m.some(a=>a>0),me?Be():je(),ge=requestAnimationFrame(be)}async function ve(){P||(n(8,P=!0),te(),!u&&c.state==="inactive"&&c.start())}function we(){P&&(c.stop(),u&&c.start())}let j=null;function te(){S&&(clearTimeout(j),n(9,j=null),S.pause(),S.currentTime=0)}function Q(a){n(3,J=a.target.paused)}async function ne(){try{await S.play()}catch(a){console.error("ERROR playing audio",a)}}function ke(){n(9,j=setTimeout(ne,Nt))}let oe;function Fe(){oe=setInterval(We,Pt)}function We(){P||(c.state==="recording"&&c.stop(),c.state==="inactive"&&c.start())}let V;function Be(){clearTimeout(H),H=null,V||(V=setTimeout(()=>{ve()},Ut))}let H;function je(){clearTimeout(V),V=null,H||(H=setTimeout(()=>{we()},zt))}function Ve(a){n(6,u=a.target.checked),c.state==="recording"&&c.stop(),u?(c.start(),Fe(),be()):clearInterval(oe)}ft(()=>{clearInterval(oe),clearTimeout(V),clearTimeout(H),S.removeEventListener("play",Q),S.removeEventListener("pause",Q),S.removeEventListener("ended",ke)});function He(a){T.call(this,e,a)}function Ke(a){T.call(this,e,a)}function Ye(a){T.call(this,e,a)}function Ge(a){T.call(this,e,a)}function Ze(a){T.call(this,e,a)}function Je(a){T.call(this,e,a)}function Qe(a){T.call(this,e,a)}function Xe(a){T.call(this,e,a)}const xe=a=>{a.code==="Escape"&&te()};function $e(a){le[a?"unshift":"push"](()=>{R=a,n(2,R),n(0,M),n(1,p)})}function et(){M=this.clientWidth,p=this.clientHeight,n(0,M),n(1,p)}return e.$$.update=()=>{e.$$.dirty[0]&1&&(o=M/re*2),e.$$.dirty[0]&7&&R&&M&&p&&(n(2,R.width=M,R),n(2,R.height=p,R)),e.$$.dirty[0]&8&&(J||ye())},[M,p,R,J,s,f,u,A,P,j,i,Oe,Ne,ve,we,te,ne,Ve,He,Ke,Ye,Ge,Ze,Je,Qe,Xe,xe,$e,et]}class Wt extends he{constructor(t){super(),pe(this,t,Ft,Ot,ae,{},null,[-1,-1])}}new Wt({target:document.getElementById("app")});
